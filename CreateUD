#!/bin/bash

#CreateUD

clear

#Create update files
sudo touch UpdateC
sudo  touch Upcode
sudo touch StartC
sudo touch StopC

#Write out StartC and StopC
echo "sudo supervisorctl start video_looper" > StartC
echo "sudo supervisorctl stop video_looper" > StopC

#Declare variables
var1=false
var2=false

#Determine store
echo -e 'What store is this for? \nPlease enter in the name, not the nsn.'
read name
clear

#Determine source
echo -e "Where are you storing you files?\n1.) CCS.\n2.)File hosting website like Dropbox or Github.\nEnter int he number corresponding to your answer."
read type

while [ $var1=false ]
do
case $type in
        1)
        #CCS
                clear
                echo "Please enter in the username of the server where your files are stored."
                read user
                echo "Enter in the public IP address of your server."
                read IP
                echo -e "Enter in the FULL file path to the video folder.\nDo not include the file name."
                read locale
                echo -e "Enter in the FULL file path to the update file folder.\nDo not include the file name."
                read locale2
                echo "Enter in the password for the user."
                read passwd

                #Write out Updatec
                echo sudo rm -r /home/pi/CCD/Videos/Temp/CRM.mp4 >> UpdateC
                echo 'sshpass -p "'$passwd'" 'scp $user@$IP:$locale/CRM.mp4 /home/pi/CCD/Videos/Temp >> UpdateC
                echo CheckC >> UpdateC
                
                #Write out Upcode
                echo sudo rm -r /home/pi/CCD/Scripts/ToRun/update > Upcode
                echo 'sshpass -p "' $passwd '" 'scp $user@$IP:$locale2 /home/pi/CCD/Scripts/ToRun >> Upcode 
                echo cd /home/pi/CCD/Scripts/ToRun >> Upcode 
                echo sudo chmod +x update >> Upcode 
                echo sudo ./update >> Upcode

                #Write out info into secure file.
                touch CCI
                echo "#This information is very sensitive. " > CCI
                echo "#Do not share with those untrusted." >> CCI
                echo "#Do NOT change the order of the entries or enter new entires." >> CCI
                echo "#Type." >> CCI
                echo  "CCS" >> CCI #5
                echo -e "#\n#\n#" >> CCI
                echo "#Store name." >> CCI
                echo $name >> CCI #10
                echo -e "#\n#\n#" >> CCI
                echo "#User." >> CCI
                echo $user >> CCI #15
                echo -e "#\n#\n#" >> CCI
                echo "#IP address of server." >> CCI
                echo $IP >> CCI #20
                echo -e "#\n#\n#" >> CCI
                echo "#File path to video file." >> CCI
                echo $locale >> CCI #25
                echo -e "#\n#\n#" >> CCI
                echo "#File path to update file." >> CCI
                echo $locale2 >> CCI #30
                echo -e "#\n#\n#" >> CCI
                echo "#Password" >> CCI
                echo $passwd >> CCI #35
                sudo cp CCI /home/pi/CCD
        break
        ;;
        2)
        #File Host
                clear

        while [ $var2=false ]
                do
                echo -e "What are you using?\n1.)Dropbox.\n2.)Github.\nEnter in the number corresponding to your answer."
                read choice
                case $choice in
                        1)
                        #Dropbox
                                clear
                                echo "Please enter in the share path to your video file."
                                read DBPath
                                echo "Please enter in the share path to your update file."
                                read UpPath

                                #Write out Updatec
                                echo sudo rm -r /home/pi/CCD/Videos/Ready/CRM.mp4 >> UpdateC
                                echo cd /home/pi/CCD/Videos/Ready >> UpdateC
                                echo sudo wget -O CRM.mp4 $DBPath >> UpdateC 
                                echo CheckC >> UpdateC

                                #Write out Upcode
                                echo sudo rm -r /home/pi/CCD/Scripts/ToRun/update > Upcode
                                echo sudo wget -O update $UpPath >> Upcode
                                echo cp update /home/pi/CCD/Scripts/ToRun >> Upcode
                                echo cd /home/pi/CCD/Scripts/ToRun >> Upcode
                                echo sudo chmod +x update >> Upcode
                                echo sudo ./update >> Upcode


                                #Write out info into secure file.
                                touch CCI
                                echo "#This information is very sensitive. " > CCI
                                echo "#Do not share with those untrusted." >> CCI
                                echo "#Do NOT change the order of the entries or enter new entires." >> CCI
                                echo "#Type." >>CCI 
                                echo  "Dropbox" >> CCI #5
                                echo -e "#\n#\n#" >> CCI
                                echo "#Store name." >> CCI
                                echo $name >> CCI #10
                                echo -e "#\n#\n#" >> CCI
                                echo "#Path to video file." >> CCI
                                echo $DBPath >> CCI #15
                                echo -e "#\n#\n#" >> CCI
                                echo "#Path to update file." >> CCI
                                echo $UpPath >> CCI #20
                                sudo cp CCI /home/pi/CCD
                      break
                        ;;
                        2)
                        #Github
                                clear
                                echo "Please enter in the path for your git repository."
                                read GHPath
                                echo "Please enter in the exact name of your repository."
                                read RepPath

                                #Write out Updatec
                                echo cd >> UpdateC
                                echo git clone $GHPath >> UpdateC
                                echo cd $RepPath >> UpdateC
                                echo sudo rm -r /home/pi/CCD/Videos/Ready/CRM.mp4 >> UpdateC
                                echo cp CRM.mp4 /home/pi/CCD/Videos/Ready >> UpdateC
                                echo CheckC >> UpdateC

                                #Write out Upcode
                                echo sudo rm -r /home/pi/CCD/Scripts/ToRun/update > Upcode
                                echo cp update /home/pi/CCD/Scripts/ToRun >> Upcode
                                echo cd /home/pi/CCD/Scripts/ToRun >> Upcode
                                echo sudo chmod +x update >> Upcode
                                echo sudo ./update >> Upcode

                                #Write out info into secure file.
                                touch CCI
                                echo "#This information is very sensitive. " > CCI
                                echo "#Do not share with those untrusted." >> CCI
                                echo "#Do NOT change the order of the entries or enter new entires." >> CCI
                                echo "#Type." >>CCI
                                echo  "Github" >> CCI #5
                                echo -e "#\n#\n#" >> CCI
                                echo "#Store name." >> CCI
                                echo $name >> CCI #10
                                echo -e "#\n#\n#" >> CCI
                                echo "#Repository link." >> CCI
                                echo $GHPath >> CCI #15
                                echo -e "#\n#\n#" >> CCI
                                echo "#Repository name." >> CCI
                                echo $RepPath >> CCI #20
                                sudo cp CCI /home/pi/CCD

                        break
                        ;;
                        *)
                        echo "Enter in a valid answer.";;
                esac
                done

        break
        ;;
        *)
                echo "Enter in a valid answer"
        ;;
esac
done
